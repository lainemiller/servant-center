<div *ngIf="grayOut" id="overlay"></div>
<p-toast position="top-center"></p-toast>
<div class="center-spinner">
  <p-progressSpinner *ngIf="showSpinner" [style]="{width: '50px', height: '50px'}" styleClass="custom-spinner" strokeWidth="5" fill="var(--surface-ground)" animationDuration=".5s"></p-progressSpinner>
</div>

<div class="p-grid">
  <div class="p-col-12">
    <app-item-header title="TREATMENT PLAN"></app-item-header>
    <div *ngIf="formView" class="form-container">
      <form [formGroup]="treatmentPlanForm" (ngSubmit)="onSubmit()">
        <div class="p-fluid p-formgrid p-grid">
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">Resident's First Name</span>
            <input
              
              type="text"
              pInputText
              formControlName="firstName"
              appNoSpecialSymbols
              customAttr="textOnly"
              placeholder="Resident's First Name"
              class="disable-field"
              [readonly]="true"
            />

            <div
              *ngIf="getControl.firstName.invalid && getControl.firstName.touched"
            >
            <div
            *ngIf="getControl.firstName.errors?.required"
              class="form-error"
              >
                <small>FirstName is required</small>
          </div>
        </div>

          </div>
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">Resident's Last Name</span>
            <input
              type="text"
              pInputText
              formControlName="lastName"
              appNoSpecialSymbols
              customAttr="textOnly"
              placeholder="Resident's Last Name"
              class="disable-field"
              [readonly]="true" 
            />
            <div
            *ngIf="getControl.lastName.invalid && getControl.lastName.touched"
          >
          <div
          *ngIf="getControl.lastName.errors?.required"
            class="form-error"
            >
              <small>LastName is required</small>
        </div>
      </div>
          </div>
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">Record #</span>
            <input
              type="text"
              pInputText
              formControlName="recordNo"
              appNoSpecialSymbols
              customAttr="numbersOnly"
              placeholder="Record #"
              class="disable-field"
              [readonly]="true"
            />

            <div
            *ngIf="getControl.recordNo.invalid && getControl.recordNo.touched"
          >
          <div
          *ngIf="getControl.recordNo.errors?.required"
            class="form-error"
            >
              <small>Record Number is required</small>
        </div>
      </div>
          </div>
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">Date Of Birth</span>
            <input
            type="text"
            pInputText
            formControlName="dateOfBirth1"
            placeholder="DateOfBirth"
            class="disable-field"
            [readonly]="true"
            
          />
            <div
              *ngIf="getControl.dateOfBirth1.invalid && getControl.dateOfBirth1.touched"
            >
            <div
            *ngIf="getControl.dateOfBirth1.errors?.required"
              class="form-error"
              >
                <small>DOB is required</small>
          </div>
        </div>
          </div>
        </div>

        <div class="p-fluid p-formgrid p-grid">
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">Intake Date</span>
            <input
            type="text"
            pInputText
            formControlName="intakeDOB"
            placeholder="Intake Date (mm/dd/yyyy)"
            class="disable-field"
            [readonly]="true"
            
            />
            <div
              *ngIf="
                getControl.intakeDOB.invalid && getControl.intakeDOB.touched
              "
            >
              <div
                *ngIf="getControl.intakeDOB.errors?.required"
                class="form-error"
              >
                <small>Intake date is required.</small>
              </div>
            </div>
          </div>
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">HMIS ID </span>
            <input
              type="text"
              pInputText
              formControlName="hmisIdNo"
              appNoSpecialSymbols
              customAttr="numbersOnly"
              placeholder="HMIS ID#"
              class="disable-field"
              [readonly]="true"
            />
            <div
              *ngIf="getControl.hmisIdNo.invalid && getControl.hmisIdNo.touched"
            >
              <div
                *ngIf="getControl.hmisIdNo.errors?.required"
                class="form-error"
              >
                <small>HMIS ID is required.</small>
              </div>
            </div>
          </div>
        </div>

        <div class="p-fluid p-formgrid p-grid">
          <div class="p-field p-col-12 p-md-6">
            <span class="label-title">Diagnosis</span>
            <textarea
              [rows]="10"
              formControlName="veteranDiagnosis"
              class="userInput"
              pInputTextarea
              placeholder="Comment"
            ></textarea>
            <div
              *ngIf="
                getControl.veteranDiagnosis.invalid &&
                getControl.veteranDiagnosis.touched
              "
            >
              <div
                *ngIf="getControl.veteranDiagnosis.errors?.required"
                class="form-error"
              >
                <small>Veteran Diagnosis is required.</small>
              </div>
            </div>
          </div>
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">Supports</span>
            <textarea
              [rows]="10"
              formControlName="veteranSupports"
              class="userInput"
              pInputTextarea
              placeholder="Comment"
            ></textarea>
            <div
              *ngIf="
                getControl.veteranSupports.invalid &&
                getControl.veteranSupports.touched
              "
            >
              <div
                *ngIf="getControl.veteranSupports.errors?.required"
                class="form-error"
              >
                <small>Support is required.</small>
              </div>
            </div>
          </div>
          <div class="p-field p-col-12 p-md-3">
            <span class="label-title">Strengths</span>
            <textarea
              [rows]="10"
              formControlName="veteranStrengths"
              class="userInput"
              pInputTextarea
              placeholder="Comment"
            ></textarea>
            <div
              *ngIf="
                getControl.veteranStrengths.invalid &&
                getControl.veteranStrengths.touched
              "
            >
              <div
                *ngIf="getControl.veteranStrengths.errors?.required"
                class="form-error"
              >
                <small>Strength is required.</small>
              </div>
            </div>
          </div>
        </div>

        <div class="p-fluid p-formgrid p-grid">
          <div class="p-field p-col-12">
            <div class="title-container">
              <p>
                <span>TREATMENT ISSUES & GOALS</span>
              </p>
            </div>
          </div>
        </div>

        <div
          formArrayName="treatmentIssues"
          *ngFor="let item of treatmentIssues.controls; let j = index"
        >
          <div [formGroupName]="j">
            <div
              *ngFor="let goal of treatmentGoals; let i = index"
              style="background: #efefef"
            >
              <div class="p-field p-col-12">
                <div class="p-grid">
                  <div class="p-col-fixed bullents bullents-margin">
                    {{ i + 1 }}
                  </div>
                  <div class="p-col heading">{{ goal.label }}</div>
                </div>
              </div>
              <div
                [formArrayName]="goal.formName"
                *ngFor="let item of goal.controls; let i = index"
              >
                <div [formGroupName]="i">
                  <div class="p-fluid p-formgrid p-grid vertical-container">
                    <div class="p-field p-col-12 p-md-3">
                      <!--goals section-->
                      <div class="box" *ngIf="goal.label === 'PHYSICAL HEALTH'">
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}a{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}a{{ j }} form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'MENTAL HEALTH'">
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}{{ j }}a"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}a form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'SUBSTANCE USE'">
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}{{ j }}b"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}b form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>

                      <div class="box" *ngIf="goal.label === 'HOUSING'">
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}c{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}c{{ j }} form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'INCOME / FINANCIAL / LEGAL'"
                      >
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}{{ j }}c"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}c form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'RELATIONSHIPS'">
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}d{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }} form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'EDUCATION'">
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}{{ j }}d"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}d form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'BENEFITS / MEDICAID / SNAP'"
                      >
                        <input
                          type="text"
                          formControlName="goals"
                          pInputText
                          class="userInput"
                          placeholder="Goal"
                          id="goal{{ i }}e{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}e{{ j }} form-error"
                        >
                          <small>Goal is required.</small>
                        </div>
                      </div>
                    </div>
                    <!--goals section ended-->
<!--PLAN SECTION STARTED-->
                    <div class="p-field p-col-12 p-md-3">
                      <div class="box" *ngIf="goal.label === 'PHYSICAL HEALTH'">
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          placeholder="Plan"
                          id="goal{{ i }}{{ j }}e"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}e form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'MENTAL HEALTH'">
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          placeholder="Plan"
                          id="goal{{ i }}f{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}f{{ j }} form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'SUBSTANCE USE'">
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          placeholder="Plan"
                          id="goal{{ i }}{{ j }}f"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}f form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>

                      <div class="box" *ngIf="goal.label === 'HOUSING'">
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          placeholder="Plan"
                          id="goal{{ i }}g{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}g{{ j }} form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'INCOME / FINANCIAL / LEGAL'"
                      >
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          placeholder="Plan"
                          id="goal{{ i }}gl{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}gl{{ j }} form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>

                      <div class="box" *ngIf="goal.label === 'RELATIONSHIPS'">
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          placeholder="Plan"
                          id="goal{{ i }}{{ j }}h"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}h form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'EDUCATION'">
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          placeholder="Plan"
                          id="goal{{ i }}i{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}i{{ j }} form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'BENEFITS / MEDICAID / SNAP'"
                      >
                        <input
                          type="text"
                          formControlName="plans"
                          pInputText
                          class="userInput"
                          placeholder="Plan"
                          id="goal{{ i }}{{ j }}i"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}i form-error"
                        >
                          <small>Plan is required.</small>
                        </div>
                      </div>
                    </div>
                    <!--PLAN SECTION ENDED-->
                    <!--STRATEGY SECTION STARTED-->
                    <div class="p-field p-col-12 p-md-3">
                      <div class="box" *ngIf="goal.label === 'PHYSICAL HEALTH'">
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          id="goal{{ i }}{{ j }}j"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}j form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'MENTAL HEALTH'">
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          id="goal{{ i }}k{{ j }}"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}k{{ j }} form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'SUBSTANCE USE'">
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          id="goal{{ i }}{{ j }}k"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}k form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>

                      <div class="box" *ngIf="goal.label === 'HOUSING'">
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          id="goal{{ i }}{{ j }}y"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}y form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'INCOME / FINANCIAL / LEGAL'"
                      >
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          id="goal{{ i }}y{{ j }}"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}y{{ j }} form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'RELATIONSHIPS'">
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          id="goal{{ i }}{{ j }}z"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}{{ j }}z form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'EDUCATION'">
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          id="goal{{ i }}z{{ j }}"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}z{{ j }} form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'BENEFITS / MEDICAID / SNAP'"
                      >
                        <input
                          type="text"
                          formControlName="strategies"
                          pInputText
                          class="userInput"
                          placeholder="Strategy"
                          appNoSpecialSymbols
                          customAttr="textWithSpace"
                          id="goal{{ i }}a{{ j }}c"
                          (focusout)="validateInput($event)"
                          (keyup)="validateInput($event)"
                        />
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}a{{ j }}c form-error"
                        >
                          <small>Strategy is required.</small>
                        </div>
                      </div>
                    </div>
                    <!--STRATEGY SECTION ENDED-->
                    <!--TARGET SECTION STARTED-->
                    <div class="p-field p-col-12 p-md-3">
                      <div class="box" *ngIf="goal.label === 'PHYSICAL HEALTH'">
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}d{{ j }}g"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }}g form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'MENTAL HEALTH'">
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}m{{ j }}d"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}m{{ j }}d form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'SUBSTANCE USE'">
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}d{{ j }}v"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }}v form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>

                      <div class="box" *ngIf="goal.label === 'HOUSING'">
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}d{{ j }}t"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }}t form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'INCOME / FINANCIAL / LEGAL'"
                      >
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}d{{ j }}u"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }}u form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'RELATIONSHIPS'">
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}d{{ j }}w"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }}w form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>
                      <div class="box" *ngIf="goal.label === 'EDUCATION'">
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}d{{ j }}k"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }}k form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>
                      <div
                        class="box"
                        *ngIf="goal.label === 'BENEFITS / MEDICAID / SNAP'"
                      >
                        <div>
                          <p-calendar
                            [inline]="false"
                            formControlName="targetDate"
                            inputId="goal{{ i }}d{{ j }}h"
                            [showIcon]="true"
                            placeholder="Target date"
                            (onSelect)="validateDate($event)"
                            (focusout)="getDate($event)"
                            [minDate]="minDateValue"
                          ></p-calendar>
                        </div>
                        <div
                          [class.hide-display]="!error"
                          class="goal{{ i }}d{{ j }}h form-error"
                        >
                          <small>Target Date is required.</small>
                        </div>
                      </div>
                    </div>
                    <!--TARGET SECTION ENDED-->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="p-fluid p-formgrid p-grid">
          <div class="p-field p-col-12">
            <textarea
              [rows]="5"
              formControlName="veteranNotes"
              class="userInput"
              pInputTextarea
              placeholder="Notes"
            ></textarea>
            <div
              *ngIf="
                getControl.veteranNotes.invalid &&
                getControl.veteranNotes.touched
              "
            >
              <small class="form-error">Veteran notes is required.</small>
            </div>
          </div>
        </div>

        <button type="submit"
         pButton label="Summary"
         [disabled]="treatmentPlanForm.invalid"
         [ngClass]="treatmentPlanForm.invalid?'p-button-outlined p-button-disabled':'p-button-primary'"
        ></button>
        <p-button
          label="Cancel"
          styleClass="p-button-link"
          (click)="resetForm()"
        ></p-button>
      </form>
    </div>
    <div *ngIf="!formView" class="form-container" id="print">
      <header class="p-d-flex p-jc-between">
        <div class="print-display">
          <i class="fas fa-arrow-alt-circle-left btn-col" (click)="showForm()"
            ><span class="btn-text">Edit</span></i
          >
        </div>
        <div class="print-display">
          <i class="fa fa-download btn-col" (click)="downloadForm()"
            ><span class="btn-text">Download</span></i
          >
        </div>
      </header>
      <div class="form-head margin-20">Treatment plan summary</div>
      <body>
        <div class="p-fluid p-formgrid p-grid margin-20">
          <section class="p-field p-col-12 p-md-2">
            <span class="form-head--data">Name: </span>
            <span class="form-head--data__light">{{ formData.firstName }} {{ formData.lastName }}</span>
          </section>
          <section class="p-field p-col-12 p-md-2">
            <span class="form-head--data">Record #: </span>
            <span class="form-head--data__light">{{ formData.recordNo }}</span>
          </section>
          <section class="p-field p-col-12 p-md-2">
            <span class="form-head--data">DOB: </span>
            <span class="form-head--data__light">{{ formData.dateOfBirth1 }}</span>
          </section>
          <section class="p-field p-col-12 p-md-2">
            <span class="form-head--data">IntakeDate: </span>
            <span class="form-head--data__light">{{ formData.intakeDOB }}</span>
          </section>
          <section class="p-field p-col-12 p-md-2">
            <span class="form-head--data">HMIS ID: </span>
            <span class="form-head--data__light">{{ formData.hmisIdNo }}</span>
          </section>
        </div>
        <div>
          <div class="p-fluid p-formgrid p-grid">
            <section class="p-field p-col-12 p-md-6">
              <span class="form-subbox">DIAGNOSIS</span>
              <div class="subbox__content">
                {{ formData.veteranDiagnosis }}
              </div>
            </section>
            <section class="p-field p-col-12 p-md-3">
              <span class="form-subbox">SUPPORTS</span>
              <div class="subbox__content">
                {{ formData.veteranSupports }}
              </div>
            </section>
            <section class="p-field p-col-12 p-md-3">
              <span class="form-subbox">STRENGTHS</span>
              <div class="subbox__content">
                {{ formData.veteranStrengths }}
              </div>
            </section>
            
          </div>
          <div>
            <div class="title-container">
              <p>
                <span>TREATMENT ISSUES & GOALS</span>
              </p>
            </div>
            <div *ngFor="let item of treatmentArray; let i = index">
              <section class="p-grid" style="margin: 10px 0 20px 0"  *ngIf="item.physicalHealth.length">
                <div class="p-col-fixed bullents">
                  1
                </div>
                <div class="p-col heading">
                  PHYSICAL HEALTH
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.physicalHealth; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.physicalHealth; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.physicalHealth; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.physicalHealth; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>
              <section class="p-grid" style="margin: 10px 0 20px 0"  *ngIf="item.mentalHealth.length">
                <div class="p-col-fixed bullents">
                  2
                </div>
                <div class="p-col heading">
                  MENTAL HEALTH
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.mentalHealth; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.mentalHealth; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.mentalHealth; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.mentalHealth; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>

              <section class="p-grid" style="margin: 10px 0 20px 0"  *ngIf="item.substanceUse.length">
                <div class="p-col-fixed bullents">
                  3
                </div>
                <div class="p-col heading">
                  SUBSTANCE USE
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.substanceUse; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.substanceUse; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.substanceUse; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.substanceUse; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>

              <section class="p-grid" style="margin: 10px 0 20px 0" *ngIf="item.housing.length">
                <div class="p-col-fixed bullents">
                  4
                </div>
                <div class="p-col heading" >
                  HOUSING
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.housing; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.housing; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.housing; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.housing; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>

              <section class="p-grid" style="margin: 10px 0 20px 0"  *ngIf="item.incomeLegal.length">
                <div class="p-col-fixed bullents">
                  5
                </div>
                <div class="p-col heading">
                  INCOME / FINANCIAL / LEGAL
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.incomeLegal; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.incomeLegal; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.incomeLegal; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.incomeLegal; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>

              <section class="p-grid" style="margin: 10px 0 20px 0" *ngIf="item.relationships.length">
                <div class="p-col-fixed bullents">
                  6
                </div>
                <div class="p-col heading" >
                  RELATIONSHIPS
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.relationships; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.relationships; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.relationships; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.relationships; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>

              <section class="p-grid" style="margin: 10px 0 20px 0" *ngIf="item.education.length">
                <div class="p-col-fixed bullents">
                  7
                </div>
                <div class="p-col heading" >
                  EDUCATION
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.education; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.education; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.education; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.education; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>

              <section class="p-grid" style="margin: 10px 0 20px 0" *ngIf="item.benefits.length">
                <div class="p-col-fixed bullents">
                  8
                </div>
                <div class="p-col heading" >
                  BENEFITS / MEDICAID / SNAP
                </div>
              </section>
              <div class="p-fluid p-formgrid p-grid">
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.benefits; let j = index">
                    <span class="form-subbox">Goal {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.goals}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.benefits; let j = index">
                    <span class="form-subbox">Plan {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.plans}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.benefits; let j = index">
                    <span class="form-subbox">Strategy {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.strategies}}
                    </div><br>
                  </div>
                </div>
                <div class="p-field p-col-12 p-md-3">
                  <div *ngFor="let a of item.benefits; let j = index">
                    <span class="form-subbox">TargetDate {{ j + 1 }}</span>
                    <div class="subbox__content">
                      {{a.targetDate | date: "shortDate"}}
                    </div><br>
                  </div>
                </div>
              </div>
            </div>
            <section class="p-field p-col-12 p-md-3">
              <span class="form-subbox">NOTES</span>
              <div class="subbox__content">
                {{ formData.veteranNotes }}
              </div>
            </section>
            <div class="blue-box print-display">
              <span>Please download PDF print, sign and scan and send to Client and
                RN for signatures and to send back to you.
              </span>
            </div>
            <div>
              <div class="signature-container">Signature</div>
              <div class="subbox__content">
                We agree to carry out the responsibilities outlined inthis
                Treatment Plan to the best of our ability.
              </div>
              <div>
                <div *ngFor="let item of persons">
                  <div class="p-fluid p-formgrid p-grid margin-10 border-low">
                    <div class="p-field p-col-12 p-md-2">
                      <div
                        class="margin-10 form-subbox signature-container__heading"
                      >
                        {{item}}
                      </div>
                    </div>
                    <div class="p-field p-col-12 p-md-4">
                      <div class="border-bot"></div>
                      <div class="signature-container__det">Name</div>
                    </div>
                    <div class="p-field p-col-12 p-md-3">
                      <div class="border-bot"></div>
                      <div class="signature-container__det">Signature</div>
                    </div>
                    <div class="p-field p-col-12 p-md-3">
                      <div class="border-bot"></div>
                      <div class="signature-container__det">Date</div>
                    </div>
                  </div>
                </div>
                  <div class="p-d-flex p-jc-between margin-30">
                    <div class="print-display">
                      <button pButton label="Save" 
                      class="p-button-outlined"
                      (click)="saveForm()"
                      ></button>
                      <p-button
                        label="Cancel"
                        (click)="resetForm()"
                        styleClass="p-button-link"
                      ></p-button>
                    </div>
                    <div class="print-display">
                      <i class="fa fa-download btn-col" (click)="downloadForm()"><span class="btn-text">Download</span></i>
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </body>
    </div>
  </div>
</div>
